import { Meta } from '@storybook/addon-docs';

<Meta title="Introduction/Typography" />

# Typography
In order for our components to look and feel like the rest of the Just Eat Takeaway.com family, we need to ensure that we are using the correct typography and styles. This document will cover how to set up typography in your application.

## Table of Contents

- [The JETSansDigital Variable Font](#the-jetsansdigital-variable-font)
- [Font Loading](#font-loading)
- [Font Optimisation (subsetting)](#font-optimisation-subsetting)

## The JETSansDigital Variable Font

`JETSansDigital` is a variable font (VF) containing all font weights and styles in a single file.

The font is available in two versions via our CDN:

| Version      | URL                                                                                                                                                      | Recommended Use                                                                                                                                    |
| ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Base**     | [JETSansDigital-VF-opt.woff2](https://pie-design-system-cdn.production.jet-external.com/fonts/JETSansDigital-VF-opt.woff2)                               | Default choice. Includes Latin characters and supports common European languages (English, French, Spanish, German, etc.).                         |
| **Extended** | [JETSansDigital-VF-optimised-extended.woff2](https://pie-design-system-cdn.production.jet-external.com/fonts/JETSansDigital-VF-optimised-extended.woff2) | Use when your app supports additional languages such as Hebrew, Bulgarian, or other Cyrillic-based languages. This version is larger in file size. |

## Font Loading

Add the following code into the `<head>` of your application:

```html
<link rel="preload" href="https://pie-design-system-cdn.production.jet-external.com/fonts/JETSansDigital-VF-opt.woff2" as="font" type="font/woff2" crossorigin>
<style>
@font-face {
    font-family: JETSansDigital;
    src: url('https://pie-design-system-cdn.production.jet-external.com/fonts/JETSansDigital-VF-opt.woff2') format("woff2");
    font-weight: 100 1000;
    font-stretch: 25% 151%;
    font-style: oblique 0deg 20deg;
    font-display: swap;
}
body {
    font-feature-settings: "tnum"; /* Enable tabular numbers */
}
</style>
```

- The first link tag will load in the `JETSansDigital` font file. The `rel=preload` attribute tells the browser to download and cache it as soon as possible.

- The `@font-face` declaration is then to apply the `JETSansDigital` font as soon as it's available (and as it's inline in the head of the page, it won't wait for the rest of the CSS to be parsed until it renders the font).

```shell
# If your application needs extended language support, replace the font URL with the extended version.
https://pie-design-system-cdn.production.jet-external.com/fonts/JETSansDigital-VF-optimised-extended.woff2
```

## Font Optimisation (subsetting)

The standard fontset comes with a huge number of glyphs and layout features that aren't required for use on the web. Therefore we optimise this fontset using a process called font-subsetting. Subsetting is the process of removing parts of the base fontset, to leave only the glyphs and features that you require.

### How to subset a font

To subset a base font like the one we use, you will need to use a command line tool called `pyftsubset` which is available as part of the fonttools library. For more information on installing `pyftsubset`, see this blog post which explains how to do that and covers any associated dependencies you'll also need (such as `pip`).

Once you have `pyftsubset` installed you can optimise your font!

For `JETSansDigital`, we subset `JETSansDigital-VF.ttf` with the following rules:

```shell
# JETSansDigital-VF
pyftsubset "JETSansDigital-VF.ttf" --output-file="JETSansDigital-VF-opt.woff2" --flavor=woff2 --layout-features=ccmp,locl,mark,mkmk,kern,dnom,numr,frac,tnum --unicodes=U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD
```

and for our extended subset, we use the following extended unicode settings:

```shell
# JETSansDigital-VF-optimised-extended
pyftsubset "JETSansDigital-VF.ttf" --output-file="JETSansDigital-VF-optimised-extended.woff2" --flavor=woff2 --layout-features=ccmp,locl,mark,mkmk,kern,dnom,numr,frac,tnum --unicodes=U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD,U+0100-017F,U+0400-04FF,U+0401,U+0451,U+0404,U+0454,U+0406,U+0456,U+0407,U+0457,U+040D,U+045D,U+040E,U+045E,U+0490,U+0491,U+0590-05FF
```

### Breaking the command down

So what do the above commands actually do and what does each setting mean?

Let's break it down step-by-step:

- `pyftsubset "JETSansDigital-VF.ttf" --output-file="JETSansDigital-VF-opt.woff2"`

This runs the pyftsubset tool on the `JETSansDigital-VF.ttf` file and outputs the results file as `JETSansDigital-VF-opt.woff2`.

- `--flavor=woff2`

Optimise the file in `woff2` format (can be set to `woff` to output the file as a woff, as well as needing to change the `--output-file` value).

- `--layout-features=ccmp,locl,mark,mkmk,kern,dnom,numr,frac,tnum`

Keeps the specified layout features as part of the sub-setted font. For more details on each of these layout features, check out the following resources:

- [`ccmp`](https://docs.microsoft.com/en-us/typography/opentype/spec/features_ae#ccmp) – This feature permits composition/decompostion of glyphs.
- [`locl`](https://www.preusstype.com/techdata/otf_locl.php) – Allow localised variants of specific letters/glyphs.
- [`mark`](https://docs.microsoft.com/en-us/typography/opentype/spec/features_ko#tag-mark) – Positions mark glyphs with respect to base glyphs.
- [`mkmk`](https://docs.microsoft.com/en-us/typography/opentype/spec/features_ko#tag-mkmk) – Positions mark glyphs with respect to other marks.
- [`kern`](https://www.preusstype.com/techdata/otf_kern.php) – Adjusts the amount of space between glyphs, generally to provide optically consistent spacing between glyphs.
- [`dnom`](https://www.preusstype.com/techdata/otf_dnom.php) – Short for denominators, this replaces selected figures which follow a slash with denominator figures.
- [`numr`](https://www.preusstype.com/techdata/otf_numr.php) – Short for numerators, this replaces selected figures which precede a slash with numerator figures, and replaces the typographic slash with the fraction slash.
- [`frac`](https://www.preusstype.com/techdata/otf_frac.php) – Short for fractions, this replaces figures separated by a slash with 'common' (diagonal) fractions.
- [`tnum`](https://www.fonts.com/content/learning/fontology/level-3/numbers/proportional-vs-tabular-figures) – Short for tabular figures, this deals with number spacing.


- `--unicodes=U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD`

Specifies which characters to include as part of our optimised set. This character set is the same as those specified by Google font sets – more information on which [can be found in this blog post](https://markoskon.com/creating-font-subsets/#characters).
